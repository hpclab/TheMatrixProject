<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_67) on Mon Sep 01 14:10:28 CEST 2014 -->
<title>MatrixSort</title>
<meta name="date" content="2014-09-01">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MatrixSort";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MatrixSort.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixScriptInput.html" title="class in it.cnr.isti.thematrix.scripting.modules"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixUnion.html" title="class in it.cnr.isti.thematrix.scripting.modules"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?it/cnr/isti/thematrix/scripting/modules/MatrixSort.html" target="_top">Frames</a></li>
<li><a href="MatrixSort.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_java.util.AbstractMap">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">it.cnr.isti.thematrix.scripting.modules</div>
<h2 title="Class MatrixSort" class="title">Class MatrixSort</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>java.util.AbstractMap&lt;K,V&gt;</li>
<li>
<ul class="inheritance">
<li>java.util.HashMap&lt;java.lang.String,<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/Symbol.html" title="class in it.cnr.isti.thematrix.scripting.sys">Symbol</a>&lt;?&gt;&gt;</li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/SymbolTable.html" title="class in it.cnr.isti.thematrix.scripting.sys">it.cnr.isti.thematrix.scripting.sys.SymbolTable</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html" title="class in it.cnr.isti.thematrix.scripting.sys">it.cnr.isti.thematrix.scripting.sys.DatasetRecord</a></li>
<li>
<ul class="inheritance">
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">it.cnr.isti.thematrix.scripting.sys.MatrixModule</a></li>
<li>
<ul class="inheritance">
<li>it.cnr.isti.thematrix.scripting.modules.MatrixSort</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd>java.io.Serializable, java.lang.Cloneable, java.util.Map&lt;java.lang.String,<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/Symbol.html" title="class in it.cnr.isti.thematrix.scripting.sys">Symbol</a>&lt;?&gt;&gt;</dd>
</dl>
<hr>
<br>
<pre>public class <span class="strong">MatrixSort</span>
extends <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></pre>
<div class="block">This class implements the SortModule functionality using the Jerboa on-disk
 FileSorter, with some caveats about concurrency. Class initialization reads
 the data from the input and stages it to disk in order to sort it. Sorting
 requires all the data and some time, and data pull requests for MatrixSort
 cannot return until the data is there. <br>
 All calls to MatrixSort that needs actual data (
 <code>hasmore() next() attributes() get()</code> ) are protected by the
 semaphore <code>phase</code> (mutual exclusion of those methods) and will
 call the sort() function if data is not yet there. Only once the sorting is
 done (see <code>sort()</code>) the specific primitive is processed, the
 semaphore is released and other data-accessing method are enabled. Class
 relies on buffering: there is no need for semaphore fairness as we only
 expect a single thread to be able to call us at a time (otherwise there would
 be a buffer in between).<br>
 
 FIXME This class creates a FileInputModule on the fly, thus possibly creating
 an issue with postprocessing and linking other modules; I'm trying to creat
 the InputModule a bit earlier.
 
 TODO in case of a shortcut with a MatrixFileInput, use the tempfile to do a
 raw copy of the input, which is then passed to the file sorter; this is to
 avoid touching the original input file, which may be a shared or a permanent
 one.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>edoardovacchi massimo</dd>
<dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../serialized-form.html#it.cnr.isti.thematrix.scripting.modules.MatrixSort">Serialized Form</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested_class_summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<ul class="blockList">
<li class="blockList"><a name="nested_classes_inherited_from_class_java.util.AbstractMap">
<!--   -->
</a>
<h3>Nested classes/interfaces inherited from class&nbsp;java.util.AbstractMap</h3>
<code>java.util.AbstractMap.SimpleEntry&lt;K,V&gt;, java.util.AbstractMap.SimpleImmutableEntry&lt;K,V&gt;</code></li>
</ul>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#inputTable">inputTable</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.concurrent.Semaphore</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#phase">phase</a></strong></code>
<div class="block">prevent any data read method before the sorting phase is complete</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#readSortedModule">readSortedModule</a></strong></code>
<div class="block">reader module that gets back the sorted data from disc</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#readyFileName">readyFileName</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#schemaName">schemaName</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static long</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#serialVersionUID">serialVersionUID</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#skipInputFileCreation">skipInputFileCreation</a></strong></code>
<div class="block">still unused: disable creation of the input temporary file (we need to
 get the file from somewhere!)</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#sorted">sorted</a></strong></code>
<div class="block">true as soon as we enter the sort routine</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#sortFieldNames">sortFieldNames</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#tempBaseName">tempBaseName</a></strong></code>
<div class="block">temporary file name stripped off of path and csv suffix</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html" title="class in it.cnr.isti.thematrix.mapping.utils">CSVFile</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#tempCSV">tempCSV</a></strong></code>
<div class="block">The writer for the intermediate file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.io.File</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#tempFile">tempFile</a></strong></code>
<div class="block">temporary file where the sorting happens</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#tempFileName">tempFileName</a></strong></code>
<div class="block">temporary file full absolute pathname; it sits in the iad directory</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#writeUnsortedModule">writeUnsortedModule</a></strong></code>
<div class="block">FIXME write module YET UNUSED ; should rewrite the data stream to disc</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields_inherited_from_class_it.cnr.isti.thematrix.scripting.sys.MatrixModule">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;it.cnr.isti.thematrix.scripting.sys.<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></h3>
<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#name">name</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#MatrixSort(java.lang.String,%20java.lang.String,%20java.lang.String,%20java.util.List)">MatrixSort</a></strong>(java.lang.String&nbsp;name,
          java.lang.String&nbsp;inputTable,
          java.lang.String&nbsp;schema,
          java.util.List&lt;java.lang.String&gt;&nbsp;fieldNames)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/Symbol.html" title="class in it.cnr.isti.thematrix.scripting.sys">Symbol</a>&lt;?&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#attributes()">attributes</a></strong>()</code>
<div class="block">Forwards the data access to the actual reading module</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#changeInput(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">changeInput</a></strong>(<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a>&nbsp;m)</code>
<div class="block">Special method used to hack the input of a module to a different module
 <b>with the same schema</b>.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#copyFile(java.io.File,%20java.io.File)">copyFile</a></strong>(java.io.File&nbsp;sourceFile,
        java.io.File&nbsp;destFile)</code>
<div class="block">Utility function to manage copying a large file either via the OS native
 IO (quickest, on 64bit JVM) or via standard Java streams.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#exec()">exec</a></strong>()</code>
<div class="block">EXECUTION</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#getInput()">getInput</a></strong>()</code>
<div class="block">Get the input module, needed for postprocessing the graph.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#hasMore()">hasMore</a></strong>()</code>
<div class="block">Returns true if there are more lines to read from the sorted data.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#next()">next</a></strong>()</code>
<div class="block">Skips to the next row of the sorted data.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#overrideInputFile(java.lang.String)">overrideInputFile</a></strong>(java.lang.String&nbsp;fullname)</code>
<div class="block">UNTESTED set the sort module for using an already existing input file; we
 need this as the condition is detected after class creation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#reset()">reset</a></strong>()</code>
<div class="block">likely not going to be supported, but may be</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#setup()">setup</a></strong>()</code>
<div class="block">setup the sort module.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#sort()">sort</a></strong>()</code>
<div class="block">Starts the sorting algorithm.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixSort.html#toString()">toString</a></strong>()</code>
<div class="block">SUPPORT METHODS</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_it.cnr.isti.thematrix.scripting.sys.MatrixModule">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;it.cnr.isti.thematrix.scripting.sys.<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></h3>
<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#addConsumer(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">addConsumer</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#get(java.lang.Object)">get</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#getConsumers()">getConsumers</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#getLogicalConsumers()">getLogicalConsumers</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#getReferenceCount()">getReferenceCount</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#hasOneInput()">hasOneInput</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#schemaMatches(java.lang.String)">schemaMatches</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#setLogicalConsumer(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">setLogicalConsumer</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#setLogicalConsumers(java.util.List)">setLogicalConsumers</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#substituteInput(it.cnr.isti.thematrix.scripting.sys.MatrixModule,%20it.cnr.isti.thematrix.scripting.sys.MatrixModule)">substituteInput</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_it.cnr.isti.thematrix.scripting.sys.DatasetRecord">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;it.cnr.isti.thematrix.scripting.sys.<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetRecord</a></h3>
<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#clear()">clear</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#deepCopy()">deepCopy</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#emptyRecord(it.cnr.isti.thematrix.scripting.sys.DatasetRecord)">emptyRecord</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#getSchema()">getSchema</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#isSchemaEmpty()">isSchemaEmpty</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#linkTo(java.util.List)">linkTo</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#put(java.lang.String,%20it.cnr.isti.thematrix.scripting.sys.Symbol)">put</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#setAll(it.cnr.isti.thematrix.scripting.sys.DatasetRecord)">setAll</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#setSchema(it.cnr.isti.thematrix.scripting.sys.DatasetSchema)">setSchema</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_it.cnr.isti.thematrix.scripting.sys.SymbolTable">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;it.cnr.isti.thematrix.scripting.sys.<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/SymbolTable.html" title="class in it.cnr.isti.thematrix.scripting.sys">SymbolTable</a></h3>
<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/SymbolTable.html#isCompatible(java.lang.String,%20java.lang.String)">isCompatible</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/SymbolTable.html#putAll(java.util.Collection)">putAll</a>, <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/SymbolTable.html#set(java.lang.String,%20T)">set</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.util.HashMap">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.util.HashMap</h3>
<code>clone, containsKey, containsValue, entrySet, isEmpty, keySet, putAll, remove, size, values</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.util.AbstractMap">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.util.AbstractMap</h3>
<code>equals, hashCode</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>finalize, getClass, notify, notifyAll, wait, wait, wait</code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.util.Map">
<!--   -->
</a>
<h3>Methods inherited from interface&nbsp;java.util.Map</h3>
<code>equals, hashCode</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="serialVersionUID">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serialVersionUID</h4>
<pre>private static final&nbsp;long serialVersionUID</pre>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../../constant-values.html#it.cnr.isti.thematrix.scripting.modules.MatrixSort.serialVersionUID">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="sortFieldNames">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sortFieldNames</h4>
<pre>private final&nbsp;java.util.List&lt;java.lang.String&gt; sortFieldNames</pre>
</li>
</ul>
<a name="inputTable">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>inputTable</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a> inputTable</pre>
</li>
</ul>
<a name="tempFileName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tempFileName</h4>
<pre>private&nbsp;java.lang.String tempFileName</pre>
<div class="block">temporary file full absolute pathname; it sits in the iad directory</div>
</li>
</ul>
<a name="tempBaseName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tempBaseName</h4>
<pre>private&nbsp;java.lang.String tempBaseName</pre>
<div class="block">temporary file name stripped off of path and csv suffix</div>
</li>
</ul>
<a name="tempFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tempFile</h4>
<pre>private&nbsp;java.io.File tempFile</pre>
<div class="block">temporary file where the sorting happens</div>
</li>
</ul>
<a name="readSortedModule">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readSortedModule</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a> readSortedModule</pre>
<div class="block">reader module that gets back the sorted data from disc</div>
</li>
</ul>
<a name="writeUnsortedModule">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeUnsortedModule</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a> writeUnsortedModule</pre>
<div class="block">FIXME write module YET UNUSED ; should rewrite the data stream to disc</div>
</li>
</ul>
<a name="schemaName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>schemaName</h4>
<pre>private&nbsp;java.lang.String schemaName</pre>
</li>
</ul>
<a name="tempCSV">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>tempCSV</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html" title="class in it.cnr.isti.thematrix.mapping.utils">CSVFile</a> tempCSV</pre>
<div class="block">The writer for the intermediate file.</div>
</li>
</ul>
<a name="phase">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>phase</h4>
<pre>private&nbsp;java.util.concurrent.Semaphore phase</pre>
<div class="block">prevent any data read method before the sorting phase is complete</div>
</li>
</ul>
<a name="sorted">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sorted</h4>
<pre>private&nbsp;boolean sorted</pre>
<div class="block">true as soon as we enter the sort routine</div>
</li>
</ul>
<a name="skipInputFileCreation">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>skipInputFileCreation</h4>
<pre>private&nbsp;boolean skipInputFileCreation</pre>
<div class="block">still unused: disable creation of the input temporary file (we need to
 get the file from somewhere!)</div>
</li>
</ul>
<a name="readyFileName">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>readyFileName</h4>
<pre>private&nbsp;java.lang.String readyFileName</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MatrixSort(java.lang.String, java.lang.String, java.lang.String, java.util.List)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MatrixSort</h4>
<pre>public&nbsp;MatrixSort(java.lang.String&nbsp;name,
          java.lang.String&nbsp;inputTable,
          java.lang.String&nbsp;schema,
          java.util.List&lt;java.lang.String&gt;&nbsp;fieldNames)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setup()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setup</h4>
<pre>public&nbsp;void&nbsp;setup()</pre>
<div class="block">setup the sort module.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#setup()">setup</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
</dl>
</li>
</ul>
<a name="overrideInputFile(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>overrideInputFile</h4>
<pre>public&nbsp;void&nbsp;overrideInputFile(java.lang.String&nbsp;fullname)</pre>
<div class="block">UNTESTED set the sort module for using an already existing input file; we
 need this as the condition is detected after class creation. The method
 shall be called after setup, this is a bit of a problem later on.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>fullname</code> - </dd></dl>
</li>
</ul>
<a name="changeInput(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>changeInput</h4>
<pre>public&nbsp;void&nbsp;changeInput(<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a>&nbsp;m)</pre>
<div class="block"><strong>Description copied from class:&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#changeInput(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">MatrixModule</a></code></strong></div>
<div class="block">Special method used to hack the input of a module to a different module
 <b>with the same schema</b>.
 
 By default (if not overridden by a concrete module class) it will emit a
 line in the log. This method is needed for relinking those modules that
 keep a reference to their source modules after their setup() call
 (examples: Filter, Product), each time we need to modify the graph of
 modules right before execution of the script (postprocessing in
 TheMatrix.sys, SortModule and others).
 
 Method needed whenever we want to add a buffer module with its proxy
 modules. This always happens after the module chain has been already
 built by the interpreter.
 
 Method used to have a by-default error behaviour as 1) the input variable
 has not been standardized in this abstract class; 2) there can be
 specific dependencies with code in the setup, exec and reset methods.
 
 Currently, it just logs (i.e. all modules which need it MUST override it,
 or they will compute on void/incorrect data).
 
 FIXME rewrite following quick and dirty notes about the effect of
 changing inputs
 
 per il filter: change input analizza i due riferimenti ai termini da
 confrontare; <br>
 li cambia con il nuovo input. se la seconda colonna non viene trovata
 vuol dire che era una costante e viene ignorata. (questo perche' il
 filter puo' usare piu' colonne del suo unico input).
 
 per il product e in generale per tutti i moduli con due input distinti <br>
 c'e' il problema di capire quale stiamo andando a sostituire, la
 changeinput con un solo parametro non basta
 
 TODO In the future, we may refactor MatrixModule to contain the input
 reference, taking care of the common case.</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#changeInput(it.cnr.isti.thematrix.scripting.sys.MatrixModule)">changeInput</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
<dt><span class="strong">Parameters:</span></dt><dd><code>m</code> - the new module to be set as input (passed by reference, does
            not need to belong to the module list).</dd></dl>
</li>
</ul>
<a name="getInput()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInput</h4>
<pre>public&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a>&nbsp;getInput()</pre>
<div class="block">Get the input module, needed for postprocessing the graph. Use with great
 care.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the input module</dd></dl>
</li>
</ul>
<a name="exec()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>exec</h4>
<pre>public&nbsp;void&nbsp;exec()</pre>
<div class="block">EXECUTION</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#exec()">exec</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
</dl>
</li>
</ul>
<a name="sort()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sort</h4>
<pre>private&nbsp;void&nbsp;sort()</pre>
<div class="block">Starts the sorting algorithm. Receive all the data; dump it to disc
 (possibly in batches); at data end, call the File Sorter; when sorted,
 open the file for reading; enable the hasMore(), next() and get methods
 
 TODO: need the documentation about branches</div>
</li>
</ul>
<a name="hasMore()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasMore</h4>
<pre>public&nbsp;boolean&nbsp;hasMore()</pre>
<div class="block">Returns true if there are more lines to read from the sorted data.
 hasMore() of Sort is actually reading from the sorted file after it has
 been sorted on disk. It has to<br>
 stall until all the data is collected, then<br>
 trigger the sorting code<br>
 trigger the initialization of a FileInput Module from the sorted output<br>
 from then, piggyback on the hasMore of the FileInput.<br>
 Eventually, it'll need to check that there are more receivers for the
 same input (maybe create more FileInput modules ?)</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#hasMore()">hasMore</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>true until the dataset has reached its last record</dd></dl>
</li>
</ul>
<a name="next()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>next</h4>
<pre>public&nbsp;void&nbsp;next()</pre>
<div class="block">Skips to the next row of the sorted data. next() of Sort is actually
 reading from the sorted file after it has been sorted on disk. It has to<br>
 stall until all the data is collected, then<br>
 trigger the sorting code<br>
 trigger the initialization of a FileInput Module from the sorted output<br>
 from then, piggyback on the hasMore of the FileInput.<br>
 Eventually, it'll need to check that there are more receivers for the
 same input (maybe create more FileInput modules ?)</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#next()">next</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
</dl>
</li>
</ul>
<a name="attributes()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>attributes</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/Symbol.html" title="class in it.cnr.isti.thematrix.scripting.sys">Symbol</a>&lt;?&gt;&gt;&nbsp;attributes()</pre>
<div class="block">Forwards the data access to the actual reading module</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html#attributes()">attributes</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetRecord.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetRecord</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>the list of symbols that belong to this record, in the order
 specified at the moment of its creation</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;java.lang.String&nbsp;toString()</pre>
<div class="block">SUPPORT METHODS</div>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#toString()">toString</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
</dl>
</li>
</ul>
<a name="reset()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reset</h4>
<pre>public&nbsp;void&nbsp;reset()</pre>
<div class="block">likely not going to be supported, but may be</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html#reset()">reset</a></code>&nbsp;in class&nbsp;<code><a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/MatrixModule.html" title="class in it.cnr.isti.thematrix.scripting.sys">MatrixModule</a></code></dd>
</dl>
</li>
</ul>
<a name="copyFile(java.io.File, java.io.File)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>copyFile</h4>
<pre>private static&nbsp;void&nbsp;copyFile(java.io.File&nbsp;sourceFile,
            java.io.File&nbsp;destFile)
                      throws java.io.IOException</pre>
<div class="block">Utility function to manage copying a large file either via the OS native
 IO (quickest, on 64bit JVM) or via standard Java streams. On a 32bit JVM,
 the slower method works for files larger than the available address
 space, that cannot be memory-mapped.
 
 FIXME this function and the related imports (NIO, InputStream and
 OutputStream) should be moved to an utility class. There should also be
 some logging of runtime info.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>sourceFile</code> - </dd><dd><code>destFile</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MatrixSort.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixScriptInput.html" title="class in it.cnr.isti.thematrix.scripting.modules"><span class="strong">Prev Class</span></a></li>
<li><a href="../../../../../../it/cnr/isti/thematrix/scripting/modules/MatrixUnion.html" title="class in it.cnr.isti.thematrix.scripting.modules"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?it/cnr/isti/thematrix/scripting/modules/MatrixSort.html" target="_top">Frames</a></li>
<li><a href="MatrixSort.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested_classes_inherited_from_class_java.util.AbstractMap">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
