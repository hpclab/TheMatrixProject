<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_67) on Mon Sep 01 14:10:27 CEST 2014 -->
<title>CSVFile</title>
<meta name="date" content="2014-09-01">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="CSVFile";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSVFile.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/ProcOutpatBean.html" title="class in it.cnr.isti.thematrix.mapping.utils"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?it/cnr/isti/thematrix/mapping/utils/CSVFile.html" target="_top">Frames</a></li>
<li><a href="CSVFile.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">it.cnr.isti.thematrix.mapping.utils</div>
<h2 title="Class CSVFile" class="title">Class CSVFile</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>it.cnr.isti.thematrix.mapping.utils.CSVFile</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">CSVFile</span>
extends java.lang.Object</pre>
<div class="block">Class to manage CSV files in TheMatrix. THIS DOCUMENTATION IS A STUB! <br>
 
 Access the CSV file itself and its XML metafile / checksum, create/validate them. Provide methods to access the
 elements of the CSV (header, columns, rows). The actual low-level access happens via the Jerboa
 <code>ReadCSVFile</code> class. The class currently opens the disk file only when the data is needed. The public
 <code>hasNext()</code> method can trigger this. <br>
 The class manages an in-memory buffer of the header of the file and of its body (the actual data). Some methods only
 act on the in-memory representation, other ones transfer between memory and file system.
 
 Important: the content of the file is represented as a double-nested ArrayList of Strings :
 <code>ArrayList<ArrayList<String>> content;</code>. The outer Array represents the <b>columns</b>, the inner one the
 <b>rows</b>.
 
 <br>
 TODO check why on earth it was done this way, if reading and writing is not done column-wise.<br>
 TODO the class provides both reading and writing functions, and makes lazy initialization of fields with unclear
 order and constraints; its interface needs redesign with clearer separation of concerns
 
 FIXME add dealing with file schemata from the new implementation of TheMatrix
 FIXME better define the purpose of the class, possibly separating more clearly the read and write behaviour. 
 
 TODO An optimization when using this class as an buffer between modules (e.g. before a sort); it should be possible
 to check if there was data written to disk, so if the file is shorter than the batch size the following module can
 directly read data from memory.</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>giacomo, iacopo, massimo</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.io.BufferedWriter</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#bufferedWriter">bufferedWriter</a></strong></code>
<div class="block">BufferedWriter can be built from DeflaterOutputStream</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#completePath">completePath</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#compression">compression</a></strong></code>
<div class="block">compression : indicates type of compression for read/write the file</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.util.ArrayList&lt;java.lang.String&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#content">content</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Iterator&lt;java.util.List&lt;java.lang.String&gt;&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#csvIterator">csvIterator</a></strong></code>
<div class="block">the actual Iterator is provided by Jerboa -- ReadCSVFile class -> CSVFileIterator private class; has no remove
 operation</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#discardedRowCount">discardedRowCount</a></strong></code>
<div class="block">The number of (bogus?) rows we had to discard because of a mismatched field number.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#fileName">fileName</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#fileRowCursor">fileRowCursor</a></strong></code>
<div class="block">The amount of rows we have read from the start, allows tracing data errors.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#header">header</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#initialBatchSize">initialBatchSize</a></strong></code>
<div class="block">Field used to remember the initial batch size (i.e.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#mappedHeader">mappedHeader</a></strong></code>
<div class="block">Contains the target header (IAD) when remapping data columns LIAD-> IAD, and when reading data from a CSV file on
 disc.<br>
 Two different uses related to the two behaviours of the class in reading/writing.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#path">path</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../../org/erasmusmc/utilities/ReadCSVFile.html" title="class in org.erasmusmc.utilities">ReadCSVFile</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#reader">reader</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#rowCursor">rowCursor</a></strong></code>
<div class="block">Internal cursor to implement iterator methods for accessing the data row by row</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#rowsInBuffer">rowsInBuffer</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a></code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#schema">schema</a></strong></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#version">version</a></strong></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.util.zip.ZipEntry</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#zipEntry">zipEntry</a></strong></code>
<div class="block">zipEntry: entry for zip file</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.zip.ZipOutputStream</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#zipOutStream">zipOutStream</a></strong></code>
<div class="block">zipOutStream: output Stream for zip file</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#CSVFile(java.lang.String,%20java.lang.String,%20java.lang.String)">CSVFile</a></strong>(java.lang.String&nbsp;path,
       java.lang.String&nbsp;fileName,
       java.lang.String&nbsp;version)</code>
<div class="block">Creates a new instance of <code>CSVFile</code>.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colOne"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#CSVFile(java.lang.String,%20java.lang.String,%20java.lang.String,%20it.cnr.isti.thematrix.common.Enums.CompressionType)">CSVFile</a></strong>(java.lang.String&nbsp;path,
       java.lang.String&nbsp;fileName,
       java.lang.String&nbsp;version,
       <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compression)</code>
<div class="block">Creates a new instance of <code>CSVFile</code> setting the compression type.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#checkExistence(java.lang.String,%20java.lang.String)">checkExistence</a></strong>(java.lang.String&nbsp;path,
              java.lang.String&nbsp;datasetName)</code>
<div class="block">DOCUMENT ME</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#checkExistence(java.lang.String,%20java.lang.String,%20boolean)">checkExistence</a></strong>(java.lang.String&nbsp;path,
              java.lang.String&nbsp;datasetName,
              boolean&nbsp;ignoreXML)</code>
<div class="block">Returns true if both the .csv (or .csv.gzip or .csv.zip) and .xml files exist for the specified dataset.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#closeFile()">closeFile</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#compareHeaders(java.util.Collection,%20java.util.Collection)">compareHeaders</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;h1,
              java.util.Collection&lt;java.lang.String&gt;&nbsp;h2)</code>
<div class="block">Awfully compare the definition of two headers.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#computeChecksum(int,%20java.lang.String)">computeChecksum</a></strong>(int&nbsp;type,
               java.lang.String&nbsp;filename)</code>
<div class="block">Computes the checksum for the specific file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#createMetaXml(java.lang.String,%20java.lang.String,%20java.lang.String)">createMetaXml</a></strong>(java.lang.String&nbsp;path,
             java.lang.String&nbsp;fileName,
             java.lang.String&nbsp;version)</code>
<div class="block"><strong>Deprecated.</strong>&nbsp;</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#createMetaXml(java.lang.String,%20java.lang.String,%20java.lang.String,%20it.cnr.isti.thematrix.scripting.sys.DatasetSchema,%20it.cnr.isti.thematrix.common.Enums.CompressionType)">createMetaXml</a></strong>(java.lang.String&nbsp;path,
             java.lang.String&nbsp;fileName,
             java.lang.String&nbsp;version,
             <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a>&nbsp;schema,
             <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)</code>
<div class="block">FIXME document this method</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#createMetaXml(java.lang.String,%20java.lang.String,%20java.lang.String,%20it.cnr.isti.thematrix.common.Enums.CompressionType)">createMetaXml</a></strong>(java.lang.String&nbsp;path,
             java.lang.String&nbsp;fileName,
             java.lang.String&nbsp;version,
             <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)</code>
<div class="block"><strong>Deprecated.</strong>&nbsp;</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getColumnValues(java.lang.String)">getColumnValues</a></strong>(java.lang.String&nbsp;attribute)</code>
<div class="block"><strong>Deprecated.</strong>&nbsp;&nbsp;</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getColumnValues(java.lang.String,%20java.lang.String)">getColumnValues</a></strong>(java.lang.String&nbsp;attribute,
               java.lang.String&nbsp;defaultValue)</code>
<div class="block">Return the whole specified column of values from the in-memory buffer.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getCompletePath()">getCompletePath</a></strong>()</code>
<div class="block">accessor method to completePath</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getDiscardedRowCount()">getDiscardedRowCount</a></strong>()</code>
<div class="block">Get the number of rows discarded so far when reading a CSV file, because of field number mismatches.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getFileName()">getFileName</a></strong>()</code>
<div class="block">accessor method to file name</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getHeader()">getHeader</a></strong>()</code>
<div class="block">accessor method to the stored header for a CSV file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getMappedHeader()">getMappedHeader</a></strong>()</code>
<div class="block">accessor method to the stored header for a CSV file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getPath()">getPath</a></strong>()</code>
<div class="block">accessor method to file path</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getRowCursor()">getRowCursor</a></strong>()</code>
<div class="block">accessor method to row cursor
 
 FIXME wrong! this is the cursor inside the current buffer, not in the whole file!</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#getVersion()">getVersion</a></strong>()</code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#hasMore()">hasMore</a></strong>()</code>
<div class="block">Implements the next-row existence check to iterate over the the data in memory; can trigger loading a new batch.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#hasNext()">hasNext</a></strong>()</code>
<div class="block">Method to (open and) check that the CSV file has a next row.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#lazyReadInit()">lazyReadInit</a></strong>()</code>
<div class="block">Method to open a CSV file for reading
 
 This method initializes the ReadCSVFile (see Jerboa docs) and related iterator objects, actually opening the
 file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#loadBatch(int)">loadBatch</a></strong>(int&nbsp;batchSize)</code>
<div class="block">Loads in memory a batch of rows (of specified size) from a CSV file, into the CSVFile object.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.util.List&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#next()">next</a></strong>()</code>
<div class="block">Implements the read operation for an iterator over the data in memory; can trigger loading a new batch.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#resetContent()">resetContent</a></strong>()</code>
<div class="block">Reset in memory content of the CSV file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#save(boolean)">save</a></strong>(boolean&nbsp;append)</code>
<div class="block">Dump the CSV file to disk, using path and file name already specified at CSVFile object creation time.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#saveTo(java.lang.String,%20java.lang.String,%20boolean)">saveTo</a></strong>(java.lang.String&nbsp;path,
      java.lang.String&nbsp;fileName,
      boolean&nbsp;append)</code>
<div class="block">Save the data to a CSV file on disk; this really needs some more documentation.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setColumnValues(java.lang.String,%20java.util.Collection)">setColumnValues</a></strong>(java.lang.String&nbsp;columnName,
               java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</code>
<div class="block">Add (insert!) a collection of new values as a a specified column in the in-memory buffer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setHeader(java.util.Collection)">setHeader</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;header)</code>
<div class="block">Sets the header of the CSV file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setMappedColumnValues(java.lang.String,%20java.util.Collection)">setMappedColumnValues</a></strong>(java.lang.String&nbsp;columnName,
                     java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</code>
<div class="block">Add (insert!) a collection of new values as a a specified column in the in-memory buffer.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setMappedHeader(java.util.Collection)">setMappedHeader</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;header)</code>
<div class="block">Sets the mappedHeader of the CSV file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setSchema(it.cnr.isti.thematrix.scripting.sys.DatasetSchema)">setSchema</a></strong>(<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a>&nbsp;s)</code>
<div class="block">Set the reference schema for this CSVFile object; call this function before reading in CSV data if you want to
 check the schema matches the CSV header.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setValue(int,%20java.lang.String)">setValue</a></strong>(int&nbsp;numberColumn,
        java.lang.String&nbsp;value)</code>
<div class="block">Add a new value to the end of the specified column.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#setValueRow(java.util.Collection)">setValueRow</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</code>
<div class="block">Method to add a whole row of values to the in-memory buffer</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#validateCheckSum(java.lang.String,%20java.lang.String)">validateCheckSum</a></strong>(java.lang.String&nbsp;path,
                java.lang.String&nbsp;datasetName)</code>
<div class="block">Validates the checksum of the xml related to a CSV file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/CSVFile.html#validateCheckSum(java.lang.String,%20java.lang.String,%20it.cnr.isti.thematrix.common.Enums.CompressionType)">validateCheckSum</a></strong>(java.lang.String&nbsp;path,
                java.lang.String&nbsp;datasetName,
                <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)</code>
<div class="block">Validates the checksum of the xml related to a CSV file with compression type parameter specified.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="reader">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reader</h4>
<pre>private&nbsp;<a href="../../../../../../org/erasmusmc/utilities/ReadCSVFile.html" title="class in org.erasmusmc.utilities">ReadCSVFile</a> reader</pre>
</li>
</ul>
<a name="fileName">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileName</h4>
<pre>private&nbsp;java.lang.String fileName</pre>
</li>
</ul>
<a name="path">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>path</h4>
<pre>private&nbsp;java.lang.String path</pre>
</li>
</ul>
<a name="completePath">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>completePath</h4>
<pre>private&nbsp;java.lang.String completePath</pre>
</li>
</ul>
<a name="version">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>version</h4>
<pre>private&nbsp;java.lang.String version</pre>
</li>
</ul>
<a name="header">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>header</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.lang.String&gt; header</pre>
</li>
</ul>
<a name="content">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>content</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.util.ArrayList&lt;java.lang.String&gt;&gt; content</pre>
</li>
</ul>
<a name="mappedHeader">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mappedHeader</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.lang.String&gt; mappedHeader</pre>
<div class="block">Contains the target header (IAD) when remapping data columns LIAD-> IAD, and when reading data from a CSV file on
 disc.<br>
 Two different uses related to the two behaviours of the class in reading/writing. (1) when mapping LIAD to IAD,
 the names will match with header in the initial part; if new fields are added, they will be at the end. (2) when
 reading back in memory a CSV file, the mapped header will match the header on disc, and the header will contain
 the same fields in the schema order, so not to break the rest of the code. Content will be permuted immediately
 before returning from loadBatch().
 
 FIXME this will also need to change according to Neverlang-based schemata definitions</div>
</li>
</ul>
<a name="schema">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>schema</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a> schema</pre>
</li>
</ul>
<a name="csvIterator">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>csvIterator</h4>
<pre>private&nbsp;java.util.Iterator&lt;java.util.List&lt;java.lang.String&gt;&gt; csvIterator</pre>
<div class="block">the actual Iterator is provided by Jerboa -- ReadCSVFile class -> CSVFileIterator private class; has no remove
 operation</div>
</li>
</ul>
<a name="rowCursor">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rowCursor</h4>
<pre>private&nbsp;int rowCursor</pre>
<div class="block">Internal cursor to implement iterator methods for accessing the data row by row</div>
</li>
</ul>
<a name="fileRowCursor">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileRowCursor</h4>
<pre>private&nbsp;int fileRowCursor</pre>
<div class="block">The amount of rows we have read from the start, allows tracing data errors. Does
 not count the header line.</div>
</li>
</ul>
<a name="rowsInBuffer">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rowsInBuffer</h4>
<pre>private&nbsp;int rowsInBuffer</pre>
</li>
</ul>
<a name="initialBatchSize">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initialBatchSize</h4>
<pre>private&nbsp;int initialBatchSize</pre>
<div class="block">Field used to remember the initial batch size (i.e. buffer size) if we will be
 automatically reading the next one. Note that the CSVFile class has the
 size of the buffer as a parameter, while calling classes may have it
 defined as a constant.</div>
</li>
</ul>
<a name="discardedRowCount">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>discardedRowCount</h4>
<pre>private&nbsp;int discardedRowCount</pre>
<div class="block">The number of (bogus?) rows we had to discard because of a mismatched field number. This count is kept for the
 whole file, not only the current in-memory buffer.</div>
</li>
</ul>
<a name="compression">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>compression</h4>
<pre>private&nbsp;<a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a> compression</pre>
<div class="block">compression : indicates type of compression for read/write the file</div>
</li>
</ul>
<a name="bufferedWriter">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bufferedWriter</h4>
<pre>private&nbsp;java.io.BufferedWriter bufferedWriter</pre>
<div class="block">BufferedWriter can be built from DeflaterOutputStream</div>
</li>
</ul>
<a name="zipOutStream">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>zipOutStream</h4>
<pre>private&nbsp;java.util.zip.ZipOutputStream zipOutStream</pre>
<div class="block">zipOutStream: output Stream for zip file</div>
</li>
</ul>
<a name="zipEntry">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>zipEntry</h4>
<pre>private&nbsp;java.util.zip.ZipEntry zipEntry</pre>
<div class="block">zipEntry: entry for zip file</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="CSVFile(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>CSVFile</h4>
<pre>public&nbsp;CSVFile(java.lang.String&nbsp;path,
       java.lang.String&nbsp;fileName,
       java.lang.String&nbsp;version)</pre>
<div class="block">Creates a new instance of <code>CSVFile</code>. Stores the necessary data, but does not open the file</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>fileName</code> - </dd><dd><code>version</code> - </dd></dl>
</li>
</ul>
<a name="CSVFile(java.lang.String, java.lang.String, java.lang.String, it.cnr.isti.thematrix.common.Enums.CompressionType)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CSVFile</h4>
<pre>public&nbsp;CSVFile(java.lang.String&nbsp;path,
       java.lang.String&nbsp;fileName,
       java.lang.String&nbsp;version,
       <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compression)</pre>
<div class="block">Creates a new instance of <code>CSVFile</code> setting the compression type. Stores the necessary data, but does not open the file</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>fileName</code> - </dd><dd><code>version</code> - </dd><dd><code>compression</code> - </dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getColumnValues(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getColumnValues</h4>
<pre>public&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;getColumnValues(java.lang.String&nbsp;attribute)</pre>
<div class="block"><span class="strong">Deprecated.</span>&nbsp;<i></i></div>
<div class="block">Return the whole specified column of values from the in-memory buffer. It MAY be asked an unexistent column, now
 the default behaviour is to bomb. For backward compatibiliy, currently calls the other getColumnValues with
 extend=false.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>attribute</code> - the IAD name of the column</dd>
<dt><span class="strong">Returns:</span></dt><dd>the whole specified column of values from the in-memory buffer</dd></dl>
</li>
</ul>
<a name="getColumnValues(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getColumnValues</h4>
<pre>public&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;getColumnValues(java.lang.String&nbsp;attribute,
                                                     java.lang.String&nbsp;defaultValue)</pre>
<div class="block">Return the whole specified column of values from the in-memory buffer. It MAY be asked an unexistent column, if
 the extend parameter is not null, and the attribute is present in the mappedHeader, a fresh column of strings
 will be allocated with the provided default value, and returned. It assumes at least column 0 really exists, and
 that all columns are the same length. Note that the new column is not added to the header here, but inthe
 ValueRemapper.
 
 FIXME_DESIGN refactor this behaviour which relies on lazy initialization, it makes the code a mess</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>attribute</code> - the IAD name of the column</dd><dd><code>defaultValue</code> - default String for new column creation; disallowed if null</dd>
<dt><span class="strong">Returns:</span></dt><dd>the whole specified column of values from the in-memory buffer</dd></dl>
</li>
</ul>
<a name="setColumnValues(java.lang.String, java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setColumnValues</h4>
<pre>public&nbsp;void&nbsp;setColumnValues(java.lang.String&nbsp;columnName,
                   java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</pre>
<div class="block">Add (insert!) a collection of new values as a a specified column in the in-memory buffer. <br>
 
 FIXME <b>Warning</b> The method will actually insert a column at the specified position, possibly moving existing
 columns after it. This doesn't seem to be right, and forces the addition of columns in increasing order!
 
 TODO added option to set in the mappedHeader (extended), dangerous too if done out of order! Note that in this
 case columnName will be always be an IAD name</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>columnName</code> - the column to replace.</dd><dd><code>values</code> - the collection of values.</dd></dl>
</li>
</ul>
<a name="resetContent()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>resetContent</h4>
<pre>public&nbsp;void&nbsp;resetContent()</pre>
<div class="block">Reset in memory content of the CSV file.
 Call this function every time at the end of writing a batch of datas.
 This resolve the growth of content data structure in memory.</div>
</li>
</ul>
<a name="setMappedColumnValues(java.lang.String, java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMappedColumnValues</h4>
<pre>public&nbsp;void&nbsp;setMappedColumnValues(java.lang.String&nbsp;columnName,
                         java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</pre>
<div class="block">Add (insert!) a collection of new values as a a specified column in the in-memory buffer. <br>
 This will deal with Mapped Values (see mappedHeader). This version does NOT add columns, only replaces them.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>columnName</code> - the column to replace.</dd><dd><code>values</code> - the collection of values.</dd></dl>
</li>
</ul>
<a name="setValue(int, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setValue</h4>
<pre>public&nbsp;void&nbsp;setValue(int&nbsp;numberColumn,
            java.lang.String&nbsp;value)</pre>
<div class="block">Add a new value to the end of the specified column. Create the column if it's not already present. <br>
 
 If used properly, it basically adds values at the end, like with having a cursor at the end (BUT THERE ARE NO
 SANITY CHECKS).
 
 FIXME remove dynamic initialization of columns and simplify the code; I don't think the routine safely works when not adding at the end.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>numberColumn</code> - column to add to</dd><dd><code>value</code> - new value</dd></dl>
</li>
</ul>
<a name="setValueRow(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setValueRow</h4>
<pre>public&nbsp;void&nbsp;setValueRow(java.util.Collection&lt;java.lang.String&gt;&nbsp;values)</pre>
<div class="block">Method to add a whole row of values to the in-memory buffer</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>values</code> - must be the proper size, null is an acceptable value</dd></dl>
</li>
</ul>
<a name="getFileName()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFileName</h4>
<pre>public&nbsp;java.lang.String&nbsp;getFileName()</pre>
<div class="block">accessor method to file name</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the relative name of the instance.</dd></dl>
</li>
</ul>
<a name="getRowCursor()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRowCursor</h4>
<pre>public&nbsp;int&nbsp;getRowCursor()</pre>
<div class="block">accessor method to row cursor
 
 FIXME wrong! this is the cursor inside the current buffer, not in the whole file!</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the cursor position</dd></dl>
</li>
</ul>
<a name="getPath()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPath</h4>
<pre>public&nbsp;java.lang.String&nbsp;getPath()</pre>
<div class="block">accessor method to file path</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the absolute path of the file</dd></dl>
</li>
</ul>
<a name="getCompletePath()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCompletePath</h4>
<pre>public&nbsp;java.lang.String&nbsp;getCompletePath()</pre>
<div class="block">accessor method to completePath</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>String completePath</dd></dl>
</li>
</ul>
<a name="setHeader(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setHeader</h4>
<pre>public&nbsp;void&nbsp;setHeader(java.util.Collection&lt;java.lang.String&gt;&nbsp;header)</pre>
<div class="block">Sets the header of the CSV file.
 
 Store in the header String Collection the names of the columns.
 
 FIXME when this happens, should not the (possibly existing) file reader and iterator be discarded? Or is it
 allowed to rename the columns?</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>header</code> - A <code>Collection<String></code> of filed names to replace the current instance-stored header</dd></dl>
</li>
</ul>
<a name="setMappedHeader(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMappedHeader</h4>
<pre>public&nbsp;void&nbsp;setMappedHeader(java.util.Collection&lt;java.lang.String&gt;&nbsp;header)</pre>
<div class="block">Sets the mappedHeader of the CSV file. Store in the mappedHeader String Collection the names of the columns.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>header</code> - A <code>Collection<String></code> of filed names to replace the current instance-stored header</dd></dl>
</li>
</ul>
<a name="getHeader()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHeader</h4>
<pre>public&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;getHeader()</pre>
<div class="block">accessor method to the stored header for a CSV file. Header will be empty if the file has not been opened yet.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the instance-stored header ( a <code>Collection<String></code> )</dd></dl>
</li>
</ul>
<a name="getMappedHeader()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMappedHeader</h4>
<pre>public&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;getMappedHeader()</pre>
<div class="block">accessor method to the stored header for a CSV file. Header will be empty if the file has not been opened yet.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the instance-stored header ( a <code>Collection<String></code> )</dd></dl>
</li>
</ul>
<a name="hasNext()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasNext</h4>
<pre>public&nbsp;boolean&nbsp;hasNext()</pre>
<div class="block">Method to (open and) check that the CSV file has a next row.
 
 This method initializes the ReadCSVFile (see Jerboa docs) and related iterator objects, actually opening the file
 if not already open.
 
 TODO Method exposes the same functionality of the (private) csvIterator.hasNext() with some overhead, so is not
 used within the class. Implicit file opening may cause unwanted side-effects.
 
 FIXME deprecate this method and build a sensible iterator interface for this class</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if the CSV file has a next row.</dd></dl>
</li>
</ul>
<a name="lazyReadInit()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lazyReadInit</h4>
<pre>private&nbsp;void&nbsp;lazyReadInit()</pre>
<div class="block">Method to open a CSV file for reading
 
 This method initializes the ReadCSVFile (see Jerboa docs) and related iterator objects, actually opening the
 file.
 
 TODO rework hasNext to use this, or remove it; add sanity checks to avoid mixing read/write modes
 TODO refactor file extension as Class field ????</div>
</li>
</ul>
<a name="compareHeaders(java.util.Collection, java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>compareHeaders</h4>
<pre>private&nbsp;boolean&nbsp;compareHeaders(java.util.Collection&lt;java.lang.String&gt;&nbsp;h1,
                     java.util.Collection&lt;java.lang.String&gt;&nbsp;h2)</pre>
<div class="block">Awfully compare the definition of two headers.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>h1</code> - a collection of Strings with the field names</dd><dd><code>h2</code> - ditto</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the headers match</dd></dl>
</li>
</ul>
<a name="loadBatch(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadBatch</h4>
<pre>public&nbsp;void&nbsp;loadBatch(int&nbsp;batchSize)</pre>
<div class="block">Loads in memory a batch of rows (of specified size) from a CSV file, into the CSVFile object. If the file is
 empty it almost silently turns into a no-op.<br>
 
 Implementation assumes that header and mappedHeader are either both initialized or both undefined.
 
 FIXME No header checking memory,: if the header is not in memory we assume to be at the beginning of the file; there is
 no checking for errors or returning exceptions!<br>
 FIXME improve open file management; right now, if the header is
 not there we assume the reading cursor must be initialized<br></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>batchSize</code> - The number of rows to be read.</dd></dl>
</li>
</ul>
<a name="getDiscardedRowCount()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getDiscardedRowCount</h4>
<pre>public&nbsp;int&nbsp;getDiscardedRowCount()</pre>
<div class="block">Get the number of rows discarded so far when reading a CSV file, because of field number mismatches.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the number of rows discarded so far when reading a CSV file</dd></dl>
</li>
</ul>
<a name="next()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>next</h4>
<pre>public&nbsp;java.util.List&lt;java.lang.String&gt;&nbsp;next()</pre>
<div class="block">Implements the read operation for an iterator over the data in memory; can trigger loading a new batch.
 
 FIXME add schema handling and proper return value for method</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>a row in the data (as a List of Objects, needs to change).</dd></dl>
</li>
</ul>
<a name="hasMore()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hasMore</h4>
<pre>public&nbsp;boolean&nbsp;hasMore()
                throws java.lang.NullPointerException</pre>
<div class="block">Implements the next-row existence check to iterate over the the data in memory; can trigger loading a new batch.
 Will replace hasNext()</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the next-row existence</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.lang.NullPointerException</code></dd></dl>
</li>
</ul>
<a name="save(boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>save</h4>
<pre>public&nbsp;void&nbsp;save(boolean&nbsp;append)
          throws java.security.NoSuchAlgorithmException,
                 java.io.IOException,
                 javax.xml.bind.JAXBException</pre>
<div class="block">Dump the CSV file to disk, using path and file name already specified at CSVFile object creation time. Calls the
 more general form saveTo().</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>append</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd></dl>
</li>
</ul>
<a name="saveTo(java.lang.String, java.lang.String, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>saveTo</h4>
<pre>public&nbsp;void&nbsp;saveTo(java.lang.String&nbsp;path,
          java.lang.String&nbsp;fileName,
          boolean&nbsp;append)
            throws java.security.NoSuchAlgorithmException,
                   java.io.IOException,
                   javax.xml.bind.JAXBException</pre>
<div class="block">Save the data to a CSV file on disk; this really needs some more documentation. <br>
 
 It creates the header for CSV with specified path and name, then dumps data to the file. Can append to an
 existing file, skipping header creation if the file exists already and skip BufferedWriter definition too. Note that existing file correctness is not
 questioned: in append mode, data without header will happily trail to a an existing but empty file or to a file
 with garbage content. <br>
 To fix the behaviour of mapping IAD attributes with no source LIAD attributes, a non-null mappedHeader is used
 instead of the ordinary header at save time.
 
 FIXME There was an "undocumented feature": <b>only</b> in append mode the in-memory data are cleared after the
 save. So the first block of a long file is duplicated. The cleanup is now always enforced, need to double-check
 with the various callers if the new behavior is ok.<br>
 FIXME refactor the class to reduce the amount of special cases and duplicate functions.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - path of the file.</dd><dd><code>fileName</code> - filename to use.</dd><dd><code>append</code> - append to existing file, and do generate the header only if the file does not actually exists.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd></dl>
</li>
</ul>
<a name="checkExistence(java.lang.String, java.lang.String, boolean)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkExistence</h4>
<pre>public static&nbsp;boolean&nbsp;checkExistence(java.lang.String&nbsp;path,
                     java.lang.String&nbsp;datasetName,
                     boolean&nbsp;ignoreXML)</pre>
<div class="block">Returns true if both the .csv (or .csv.gzip or .csv.zip) and .xml files exist for the specified dataset. datasetName must not be empty BUT
 it is not checked.
 If exist more files with the same name throw Error</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - The path in which to search the dataset file.</dd><dd><code>datasetName</code> - The name of the dataset.</dd><dd><code>ignoreXML</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>a <code>Boolean</code> value, true if both conditions are met, false otherwise.</dd></dl>
</li>
</ul>
<a name="checkExistence(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkExistence</h4>
<pre>public static&nbsp;boolean&nbsp;checkExistence(java.lang.String&nbsp;path,
                     java.lang.String&nbsp;datasetName)</pre>
<div class="block">DOCUMENT ME</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>datasetName</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd></dd></dl>
</li>
</ul>
<a name="validateCheckSum(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validateCheckSum</h4>
<pre>public static&nbsp;boolean&nbsp;validateCheckSum(java.lang.String&nbsp;path,
                       java.lang.String&nbsp;datasetName)
                                throws javax.xml.bind.JAXBException,
                                       java.security.NoSuchAlgorithmException,
                                       java.io.IOException</pre>
<div class="block">Validates the checksum of the xml related to a CSV file. Heavy checksum computation can be disabled in the XML
 configuration.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>datasetName</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>true if control succeeds.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="validateCheckSum(java.lang.String, java.lang.String, it.cnr.isti.thematrix.common.Enums.CompressionType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>validateCheckSum</h4>
<pre>public static&nbsp;boolean&nbsp;validateCheckSum(java.lang.String&nbsp;path,
                       java.lang.String&nbsp;datasetName,
                       <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)
                                throws javax.xml.bind.JAXBException,
                                       java.security.NoSuchAlgorithmException,
                                       java.io.IOException</pre>
<div class="block">Validates the checksum of the xml related to a CSV file with compression type parameter specified. Heavy checksum computation can be disabled in the XML
 configuration.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>datasetName</code> - </dd><dd><code>compressionType</code> - </dd>
<dt><span class="strong">Returns:</span></dt><dd>true if control succeeds.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="createMetaXml(java.lang.String, java.lang.String, java.lang.String, it.cnr.isti.thematrix.common.Enums.CompressionType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createMetaXml</h4>
<pre>@Deprecated
public static&nbsp;void&nbsp;createMetaXml(java.lang.String&nbsp;path,
                            java.lang.String&nbsp;fileName,
                            java.lang.String&nbsp;version,
                            <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)
                          throws java.io.IOException,
                                 java.security.NoSuchAlgorithmException,
                                 javax.xml.bind.JAXBException</pre>
<div class="block"><span class="strong">Deprecated.</span>&nbsp;</div>
<div class="block">method to create a meta.xml file related to the CSV dump with compression type parameter specified.
 
 FIXME deprecated as it misses the schema, which is now mandatory</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>fileName</code> - </dd><dd><code>version</code> - </dd><dd><code>compressionType</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd></dl>
</li>
</ul>
<a name="createMetaXml(java.lang.String, java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createMetaXml</h4>
<pre>@Deprecated
public static&nbsp;void&nbsp;createMetaXml(java.lang.String&nbsp;path,
                            java.lang.String&nbsp;fileName,
                            java.lang.String&nbsp;version)
                          throws java.io.IOException,
                                 java.security.NoSuchAlgorithmException,
                                 javax.xml.bind.JAXBException</pre>
<div class="block"><span class="strong">Deprecated.</span>&nbsp;</div>
<div class="block">method to create a meta.xml file related to the CSV dump
 
 FIXME deprecated as it misses the schema, which is now mandatory</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>fileName</code> - </dd><dd><code>version</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.io.IOException</code> - if file doesn't exists</dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="createMetaXml(java.lang.String, java.lang.String, java.lang.String, it.cnr.isti.thematrix.scripting.sys.DatasetSchema, it.cnr.isti.thematrix.common.Enums.CompressionType)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createMetaXml</h4>
<pre>public static&nbsp;void&nbsp;createMetaXml(java.lang.String&nbsp;path,
                 java.lang.String&nbsp;fileName,
                 java.lang.String&nbsp;version,
                 <a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a>&nbsp;schema,
                 <a href="../../../../../../it/cnr/isti/thematrix/common/Enums.CompressionType.html" title="enum in it.cnr.isti.thematrix.common">Enums.CompressionType</a>&nbsp;compressionType)
                          throws java.io.IOException,
                                 java.security.NoSuchAlgorithmException,
                                 javax.xml.bind.JAXBException</pre>
<div class="block">FIXME document this method</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>path</code> - </dd><dd><code>fileName</code> - </dd><dd><code>version</code> - </dd><dd><code>schema</code> - </dd><dd><code>compressionType</code> - </dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd></dl>
</li>
</ul>
<a name="computeChecksum(int, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeChecksum</h4>
<pre>public static&nbsp;java.lang.String&nbsp;computeChecksum(int&nbsp;type,
                               java.lang.String&nbsp;filename)
                                        throws java.security.NoSuchAlgorithmException,
                                               java.io.IOException</pre>
<div class="block">Computes the checksum for the specific file. <br>
 
 TODO directly passing the number of rows to check, or -1, is highly unsafe. Quick-fixed, refactor and change it
 with an enum or a boolean.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>type</code> - Specify the number of row you want to use to calculate checksum. Lightweight checking (2), or full
            file checking (-1)</dd><dd><code>filename</code> - the file name over which to compute the checksum</dd>
<dt><span class="strong">Returns:</span></dt><dd>the MD5 checksum converted to a String</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="getVersion()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getVersion</h4>
<pre>public&nbsp;java.lang.String&nbsp;getVersion()</pre>
</li>
</ul>
<a name="setSchema(it.cnr.isti.thematrix.scripting.sys.DatasetSchema)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setSchema</h4>
<pre>public&nbsp;void&nbsp;setSchema(<a href="../../../../../../it/cnr/isti/thematrix/scripting/sys/DatasetSchema.html" title="class in it.cnr.isti.thematrix.scripting.sys">DatasetSchema</a>&nbsp;s)</pre>
<div class="block">Set the reference schema for this CSVFile object; call this function before reading in CSV data if you want to
 check the schema matches the CSV header. Currently calling this function is <b>mandatory</b>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>s</code> - </dd></dl>
</li>
</ul>
<a name="closeFile()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>closeFile</h4>
<pre>public&nbsp;void&nbsp;closeFile()
               throws java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/CSVFile.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../../../it/cnr/isti/thematrix/mapping/utils/ProcOutpatBean.html" title="class in it.cnr.isti.thematrix.mapping.utils"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../../index.html?it/cnr/isti/thematrix/mapping/utils/CSVFile.html" target="_top">Frames</a></li>
<li><a href="CSVFile.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
