<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_67) on Mon Sep 01 14:10:27 CEST 2014 -->
<title>MappingManager</title>
<meta name="date" content="2014-09-01">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="MappingManager";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MappingManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?it/cnr/isti/thematrix/mapping/MappingManager.html" target="_top">Frames</a></li>
<li><a href="MappingManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">it.cnr.isti.thematrix.mapping</div>
<h2 title="Class MappingManager" class="title">Class MappingManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>it.cnr.isti.thematrix.mapping.MappingManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">MappingManager</span>
extends java.lang.Object</pre>
<div class="block">This class manages the mapping of IAD datasets into CSV datasets. If needed, it can trigger the retrieval of datasets
 from DBMS (or the generation of queries for manual execution) via IADCreator. <br>
 
 FIXME the Batch size is distinct from IadCreator but locally defined</div>
<dl><dt><span class="strong">Author:</span></dt>
  <dd>massimo</dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#CSV_BATCH_SIZE">CSV_BATCH_SIZE</a></strong></code>
<div class="block">How many rows are fetched in a single batch from a CSV file.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#MappingManager()">MappingManager</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.Collection&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#checkCSVFileExistence(java.util.Collection)">checkCSVFileExistence</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;datasetNames)</code>
<div class="block">Performs CSV existence and integrity checks, performing an update if necessary.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#checkCSVFileExistence(java.lang.String)">checkCSVFileExistence</a></strong>(java.lang.String&nbsp;datasetName)</code>
<div class="block">Performs CSV existence and integrity checks, returns false if file not found/not validated.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#checkCSVFileExistence(java.lang.String,%20java.lang.String)">checkCSVFileExistence</a></strong>(java.lang.String&nbsp;dir,
                     java.lang.String&nbsp;fileName)</code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#createDataset(java.util.Collection)">createDataset</a></strong>(java.util.Collection&lt;java.lang.String&gt;&nbsp;datasetNames)</code>
<div class="block">Creates a specified set of IAD datasets.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#retrieveCSV(java.lang.String,%20java.lang.String)">retrieveCSV</a></strong>(java.lang.String&nbsp;datasetName,
           java.lang.String&nbsp;scriptName)</code>
<div class="block">Performs the retrieval of a IAD dataset (only one) from DBMS.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><strong><a href="../../../../../it/cnr/isti/thematrix/mapping/MappingManager.html#translatePersistentCsv(java.lang.String)">translatePersistentCsv</a></strong>(java.lang.String&nbsp;datasetName)</code>
<div class="block"><strong>Deprecated.</strong>&nbsp;</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="CSV_BATCH_SIZE">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>CSV_BATCH_SIZE</h4>
<pre>private final&nbsp;int CSV_BATCH_SIZE</pre>
<div class="block">How many rows are fetched in a single batch from a CSV file.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../../constant-values.html#it.cnr.isti.thematrix.mapping.MappingManager.CSV_BATCH_SIZE">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="MappingManager()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>MappingManager</h4>
<pre>public&nbsp;MappingManager()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="createDataset(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createDataset</h4>
<pre>public&nbsp;void&nbsp;createDataset(java.util.Collection&lt;java.lang.String&gt;&nbsp;datasetNames)
                   throws javax.xml.bind.JAXBException,
                          java.io.IOException,
                          java.security.NoSuchAlgorithmException,
                          <a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a>,
                          java.sql.SQLException,
                          java.lang.ClassNotFoundException,
                          <a href="../../../../../it/cnr/isti/thematrix/exception/JDBCConnectionException.html" title="class in it.cnr.isti.thematrix.exception">JDBCConnectionException</a>,
                          <a href="../../../../../it/cnr/isti/thematrix/exception/UnsupportedDatabaseDriverException.html" title="class in it.cnr.isti.thematrix.exception">UnsupportedDatabaseDriverException</a></pre>
<div class="block">Creates a specified set of IAD datasets. The method can trigger mapping of IAD CSV files and involve DMBS
 queries. <br>
 TODO streamline warning/error/progress messages, too much duplication and ambiguous messages TODO: use TheMatrix
 custom exceptions.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datasetNames</code> - The <code>Collection<String></code> of IAD datasets that need be mapped.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.lang.ClassNotFoundException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
<dd><code>java.io.IOException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a></code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/JDBCConnectionException.html" title="class in it.cnr.isti.thematrix.exception">JDBCConnectionException</a></code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/UnsupportedDatabaseDriverException.html" title="class in it.cnr.isti.thematrix.exception">UnsupportedDatabaseDriverException</a></code></dd></dl>
</li>
</ul>
<a name="checkCSVFileExistence(java.util.Collection)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCSVFileExistence</h4>
<pre>private&nbsp;java.util.Collection&lt;java.lang.String&gt;&nbsp;checkCSVFileExistence(java.util.Collection&lt;java.lang.String&gt;&nbsp;datasetNames)
                                                              throws java.security.NoSuchAlgorithmException,
                                                                     javax.xml.bind.JAXBException,
                                                                     java.io.IOException</pre>
<div class="block">Performs CSV existence and integrity checks, performing an update if necessary. Will NOT validate checksum if
 file is temporary.
 
 FIXME there is a bug with temporary files when they are compressed DO NOT ENABLE COMPRESSION YET
 
 TODO fix for compressed files
 TODO shall it be made public? <br>
 TODO refactor to use the base method which checks a single file <br></div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datasetNames</code> - A <code>Collection<String></code> of the file names that need to be checked.</dd>
<dt><span class="strong">Returns:</span></dt><dd>A <code>Collection<String></code> containing the names of missing of corrupted CSV files.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="checkCSVFileExistence(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCSVFileExistence</h4>
<pre>public&nbsp;boolean&nbsp;checkCSVFileExistence(java.lang.String&nbsp;datasetName)
                              throws java.security.NoSuchAlgorithmException,
                                     javax.xml.bind.JAXBException,
                                     java.io.IOException</pre>
<div class="block">Performs CSV existence and integrity checks, returns false if file not found/not validated.
 The integrity check is always done.
 This function cannot be called on a temporary file</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datasetName</code> - a single dataset name without extension</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if file is found and verified.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.io.IOException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd></dl>
</li>
</ul>
<a name="checkCSVFileExistence(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkCSVFileExistence</h4>
<pre>public&nbsp;boolean&nbsp;checkCSVFileExistence(java.lang.String&nbsp;dir,
                            java.lang.String&nbsp;fileName)
                              throws java.security.NoSuchAlgorithmException,
                                     javax.xml.bind.JAXBException,
                                     java.io.IOException</pre>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="translatePersistentCsv(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>translatePersistentCsv</h4>
<pre>@Deprecated
private&nbsp;void&nbsp;translatePersistentCsv(java.lang.String&nbsp;datasetName)
                             throws javax.xml.bind.JAXBException,
                                    <a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a>,
                                    java.security.NoSuchAlgorithmException,
                                    java.io.IOException</pre>
<div class="block"><span class="strong">Deprecated.</span>&nbsp;</div>
<div class="block">ADD PROPER DOCUMENTATION Performs the mapping of header and values of a CSV producing a IAD compliant dataset.
 
 Cycle though the LIAD files defined in the configuration, check that each one exists (implies MD5 checksum at the
 moment) and load a <code>CSV_BATCH_SIZE</code> batch of lines. For each file missing, set up the download from
 DBMS or the generation of the SQL query, according to the configuration; if possible create the CSV file. <br>
 
 FIXME the code seems to take care only of the first batch of the file!</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datasetName</code> - The IAD name of the dataset to be mapped.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>javax.xml.bind.JAXBException</code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a></code></dd>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
<a name="retrieveCSV(java.lang.String, java.lang.String)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>retrieveCSV</h4>
<pre>private&nbsp;void&nbsp;retrieveCSV(java.lang.String&nbsp;datasetName,
               java.lang.String&nbsp;scriptName)
                  throws java.security.NoSuchAlgorithmException,
                         java.sql.SQLException,
                         java.lang.ClassNotFoundException,
                         javax.xml.bind.JAXBException,
                         java.io.IOException,
                         <a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a>,
                         <a href="../../../../../it/cnr/isti/thematrix/exception/JDBCConnectionException.html" title="class in it.cnr.isti.thematrix.exception">JDBCConnectionException</a>,
                         <a href="../../../../../it/cnr/isti/thematrix/exception/UnsupportedDatabaseDriverException.html" title="class in it.cnr.isti.thematrix.exception">UnsupportedDatabaseDriverException</a></pre>
<div class="block">Performs the retrieval of a IAD dataset (only one) from DBMS. It creates the <code>QuerySet</code> needed for the
 given dataset name via the <code>QueryCreator</code>. The <code>QuerySet</code> is either executed via
 <code>IadCreator</code> methods, or dumped to a text file via <code>QueryCreator</code>.
 
 Note: although a collection, the QuerySet can currently only contain _one_ Query associated to _the_ only
 dbConnection.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>datasetName</code> - The name of the IAD dataset that has to be retrieved.</dd><dd><code>scriptName</code> - The name of the script that has triggered the mapping process.</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code>java.security.NoSuchAlgorithmException</code></dd>
<dd><code>java.sql.SQLException</code></dd>
<dd><code>java.lang.ClassNotFoundException</code></dd>
<dd><code>javax.xml.bind.JAXBException</code> - IOException</dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/SyntaxErrorInMappingException.html" title="class in it.cnr.isti.thematrix.exception">SyntaxErrorInMappingException</a></code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/JDBCConnectionException.html" title="class in it.cnr.isti.thematrix.exception">JDBCConnectionException</a></code></dd>
<dd><code><a href="../../../../../it/cnr/isti/thematrix/exception/UnsupportedDatabaseDriverException.html" title="class in it.cnr.isti.thematrix.exception">UnsupportedDatabaseDriverException</a></code></dd>
<dd><code>java.io.IOException</code></dd></dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/MappingManager.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li>Next Class</li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?it/cnr/isti/thematrix/mapping/MappingManager.html" target="_top">Frames</a></li>
<li><a href="MappingManager.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
