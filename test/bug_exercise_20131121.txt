/*************************************
declareSchema groupGP = [  { GP_ID : string };  { Group : string }]

// Load data  from GPgroup

GPgroup (FileInputModule)
parameters
  inputFileName = GPgroup.csv
          inputSchema   = groupGP
end

**************************************/
/**************************************
// Load data  from HOSP

HOSP (ScriptInputModule)
parameters
	scriptFilename = LoadHOSP.txt
	inputName = HOSP
	expectedSchema = IADhosp
end

// Load data  from EXE

EXE (ScriptInputModule)
parameters
	scriptFilename = LoadEXE.txt
	inputName = EXE
	expectedSchema = IADexe
end

// Load data  from PERSON

PERSON (ScriptInputModule)
parameters
	scriptFilename = LoadPERSON.txt
	inputName = PERSON
	expectedSchema = IADperson
end

// Load data  from DRUGS

DRUGS (ScriptInputModule)
parameters
	scriptFilename = LoadDRUGS.txt
	inputName = DRUGS
	expectedSchema = IADdrug
end
***************************************/
// Load data  from OUTPAT

OUTPAT (ScriptInputModule)
parameters
	scriptFilename = LoadOUTPAT.txt
	inputName = OUTPAT
	expectedSchema = IADoutpat
end

// Load data  from DDRUG

DDRUG (ScriptInputModule)
parameters
	scriptFilename = LoadDDRUG.txt
	inputName = DDRUG
	expectedSchema = IADdrug
end


// INDICATORS - PREPARE SOURCES - prepare OUTPAT

LastYearOUTPAT (FilterModule)
inputs
	IADoutpat = OUTPAT
parameters
	conditions = [{PROC_START_DATE >= 2011-01-01};{PROC_START_DATE <= 2011-12-31}]
	boolExpr = AND
end

sortedLastYearOUTPAT (SortModule)
inputs
	IADoutpat = LastYearOUTPAT
parameters
	fieldNames = [ PERSON_ID ]
end

// INDICATORS FOR POPULATION WITH DISEASES: EMOGLIC

FEMOGLIC (FilterModule)
inputs
	IADoutpat = sortedLastYearOUTPAT
parameters
//	conditions = [{PERSON_ID  != MISSING } ]
	conditions = [{PROC_COD  = "90.28.1"} ; {PROC_COD  = "90281"} ]
//	conditions = [{PROC_COD  = "90.28.1"}]
	boolExpr = OR
	filterType = discard
end

FEMOGLIC1 (FilterModule)
inputs
	IADoutpat = FEMOGLIC
parameters
//	conditions = [{PERSON_ID  != MISSING } ]
	conditions = [{PROC_COD  = "90.28.1"} ; {PROC_COD  = "90281"} ]
//	conditions = [{PROC_COD  = "90.28.1"}]
	boolExpr = OR
//	filterType = discard
end


debugFEMOGLIC (FileOutputModule)
inputs
	IADoutpat = FEMOGLIC1
parameters
	checksum = none
	compression = none	
end

