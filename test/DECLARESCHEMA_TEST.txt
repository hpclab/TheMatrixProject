/* test of declare schema : we redefine the test schemas for merge
	compare results with MERGE_TEST_B if you want   :-)
 */
// this shall pass
//declareSchema TestSchemaX = [ {KEY : int }; {ATTR_X : string}; {ATTR_X2 : string} ]

// this shall fail for the row, that will get discarded
//declareSchema TestSchemaX = [ {KEY : int }; {ATTR_X : string}; {ATTR_X2 : int} ]

// this shall fail for the row, that will get discarded
declareSchema TestSchemaX = [ {KEY : int }; {ATTR_X : string}; {ATTR_X2 : date} ]

declareSchema TestSchemaY = [ {EXTKEY : int }; {ATTRIBUTEY : string}; {ATTRIBUTEY2 : string} ]

/*					.put(new Symbol<String>("KEY", null, DataType.INT))
					.put(new Symbol<String>("ATTR_X", null, DataType.STRING))
					.put(new Symbol<String>("ATTR_X2", null, DataType.STRING));

					.put(new Symbol<String>("EXTKEY", null, DataType.INT))
					.put(new Symbol<String>("ATTRIBUTEY", null, DataType.STRING))
					.put(new Symbol<String>("ATTRIBUTEY2", null, DataType.STRING));

*/

FILEX (FileInputModule)
parameters
      inputFileName = MERGEX_1K2F.csv
      inputSchema   = TestSchemaX
end

FILEY (FileInputModule)
parameters
      inputFileName = MERGEY_B_1K2F.csv
      inputSchema   = TestSchemaY
end

// FINAL: join the list of persons with sources for diabetes
MERGEOUTPUT (MergeModule)
inputs
	TestSchemaX = FILEX
	TestSchemaY = FILEY
parameters
	primaryKey = [ KEY ]
	fieldNames = [ EXTKEY ]
end
