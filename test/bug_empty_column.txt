declareSchema bugschema = [{PERSON_ID : string} ;  {MINDATE : date } ; {DURATION : float } ]

// input result from selection DIAB_DRUGS_ORAL

RESULTDIAB_DRUGS_ORAL (FileInputModule)
parameters
	inputFileName = dati_bug_empty_column.csv
	inputSchema   = bugschema
end

NumberDIAB_DRUGS_ORDDD09 (AggregateModule)
inputs
	bugschema = RESULTDIAB_DRUGS_ORAL
parameters
	isInputSorted = false
	groupBy =  [ PERSON_ID ]
	functions = [ SUM( DURATION ), MIN(MINDATE), MAX(MINDATE) ]
	results =  [ { DurationDIAB_DRUGS_ORDDD09 : float };{ DateMinDIAB_DRUGS_ORDDD09 : date } ; { DateMaxDIAB_DRUGS_ORDDD09 : date } ]
end

