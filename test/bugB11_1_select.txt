declareSchema IADvalidEXE = [ { EXEMPTION_CODE : string } ; { EXE_END_DATE : date } ; { EXE_START_DATE : date } ; { PERSON_ID : string } ; {RowPERSON  : int}  ; {Aux : string} ]
EXErow (FileInputModule)
parameters
	inputFileName = Valid_EXE.csv
	inputSchema   = IADvalidEXE
end

EXE (DropModule)
inputs
	IADvalidEXE = EXErow
parameters
	params = [ RowPERSON ]
end

// create result of selection rule DIAB_EXE from EXE

RESULTDIAB_EXEtoClean (FilterModule)
inputs
	custom = EXE
parameters
	conditions = [{PERSON_ID = MISSING} ; { EXEMPTION_CODE matches "*250" } ; { EXEMPTION_CODE matches "*250" }]
	boolExpr= OR
end

RESULTDIAB_EXEtoDrop (RenameAttributesModule)
inputs
	custom = RESULTDIAB_EXEtoClean
parameters
	inputAttributes = [ EXE_START_DATE ]
	outputAttributes   = [ MINDATE ]
end



RESULTDIAB_EXEtoRefine (ExtendDataModule)
inputs
	custom = RESULTDIAB_EXEtoDrop
parameters
  attributes = [ {DURATION: float} ]
end

RESULTDIAB_EXE (DropModule)
inputs
	custom = RESULTDIAB_EXEtoRefine
parameters
	params = [   EXEMPTION_CODE , EXE_END_DATE , EXE_START_DATE ]
end



// Output RESULTDIAB_EXE

PostproMATRICE_DIAB_EXE (FileOutputModule)
inputs
	custom = RESULTDIAB_EXE
parameters
	checksum = none
	compression = none
end
